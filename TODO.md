Update intermediate results:
- Something better than unordered_map
- Clear out intermediate buffers after use

Broadly, generate LLVM/MLIR instead of C++.